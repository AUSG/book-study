## 11장 클라이언트 식별과 쿠키
### 개별 저복
- http는 익명으로 사용하며 상태가 없고 요청과 응답으로 통신하는 프로토콜이다.
- 사이트를 개인화시켜 사용자에게 제공하는 방법 
  - 개별 인사
  - 사용자 맞춤 추천
  - 저장된 사용자 정보
  - 세션 추적
### HTTP 헤더
> 사용자에 대한 정보를 전달하는 7가지 HTTP 헤더
- From 헤더
- User-Agent 헤더
- Referer 헤더
- Authorization 
- Client-ip 
- X-Forwarded-For 
- Cookie

- ### 클라이언트 IP 주소
- 클라이언트 ip 주소로 사용자를 식별하는 방식의 약점 
  - 사용하는 컴퓨터를 가리키기 떄문에, 공용 사용 컴퓨터에 대해서는 식별하기 힘들다. 
  - 인터넷 서비스 사용자(ISP)는 동적으로 IP주소를 할당한다. 
  - 많은 사용자는 방화벽을 사용한다. 
  - 프락시가 있을 경우 서버는 프락시의 ip를 본다.
  - 
### 사용자 로그인
웹 서버는 사용자의 이름, 비밀번호로 인증할 것을 요구할 수 있다.

### 뚱뚱한 URL
> 사용자의 상태 정보를 포함하고 있는 URL

- 문제점
  - 공유하지 못하는 URL 
    - URL이 사용자의 세션에 대한 정보가 있으므로 공유 불가
  - 캐시 사용 불가 
    - URL이 달라지므로 기존 캐시에 접근 불가
  - 서버 부하 가중
  - 이탈 
    - 사용자가 다른 페이지로 이탈했을때 다시 URL로 돌아오기가 힘들다.
  - 세션간 지속성의 부재

### 쿠키
- 식별하는 방법들 중 가장 널리 사용하는 방식
- 쿠키는 캐시와 충돌 가능 =>  쿠키에 있는 내용은 캐싱 X
- 쿠키의 타입 
  - 쿠키는 파기되는 시점에 따라 세션 쿠키(임시쿠키) , 지속 쿠키 
  - 지속 쿠키
    - 브라우저 종료, 하드웨어 재시작에도 남아있다.
  - 임시 쿠키
    - 브라우저 종료시 만료된다.
- 쿠키 동작
  - 쿠키는 key=value 의 리스트
  - Set-Cookie 같은 HTTP 응답 헤더에 기술됨
- 쿠키 상자: 클라이언트 측 상태
  - '클라이언트 측 상태' = 브라우저가 쿠키 정보를 저장할 책임 
  - Cookies 파일의 각 쿠키들
    - creation_utc, host_key, name, value, path, expire_utc, secure
- 사이트마다 각기 다른 쿠키들
  - 브라우저는 각 사이트에 2~3개의 쿠키만을 보낸다.
    - 쿠키를 모두 전달하면 성능이 크게 저하
    - 쿠키가 모든 사이트에 통용 X
    - 개인정보 문제를 일으킬 수 있음
  - Set-Cookie 응답 헤더의 Domain , Path 속성을 통해 기술
- 쿠키과 세션 추적
  - 쿠키는 수차레 트랜잭션을 만들어내는 사용자 추적에 사용
- 쿠키와 캐싱
  - 기본 원칙
    - 캐시되지 말아야 할 문서가있다면 표시하라 
    - Set-Cookie 헤더를 캐시 하는 것에 유의하라
    - Cookie 헤더를 가지고 있는 요청을 주의하라

- 쿠키, 보안 그리고 개인정보
  - 개인정보를 다루는 기술은 잘못된 의도로 사용될 수 있기 때문에 조심
  - 가장 큰 오용은 지속 쿠키를 사용하는 것 
  - 개인정보 정책에 유의하여 잘 사용한다면 쿠키는 위험성보다 트랜잭션상의 편리함이 더 큼