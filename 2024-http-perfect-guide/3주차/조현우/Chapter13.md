# 다이제스트 인증
### 특징
- 비밀번호를 절대로 네트워크를 통해 평문으로 전송하지 않느다.
- 인증 체결을 가로채서 재현하려는 악의적인 사람들을 차단한다.
- 구현하기에 따라서, 메시지 내용 위조를 막는 것도 가능하다.
- 그 외 몇몇 잘 알려진 형태의 공격을 막는다.

아직 널리 쓰이진않고, 기본인증 대신에 사용해야한다 정도로만 조언하고 있음.

##### 요약된 비밀번호를 사용해서 전달
비밀번호의 모든 걸 전달하는 게 아닌 요약된 형태만 전달하는 방식.
서버와 클라는 모두 비밀번호를 알고 있기 때문에, 검증할 수 있음.

##### 단방향 요약
단방향 해시 함수를 사용함

##### 재전송방지를 위한 난스(nonce) 사용
재전송 공격을 방지하기 위해 서버는 클라이언트에게 난스라고 불리는 특별한, 자주 바뀌는 증표를 건네준다.
난스를 곁들여서 해시하도록 하면 비밀번호 요약값이 매번 바뀌게 될 것임.

##### 사전 인가
사전 인가를 하게 되면 요청/인증요구 사이클이 생략되어, 성능 개선 효과가 존재한다.
이를 위해 클라에서 이후 만들어질 난스를 미리 알아내서 사전 인가하도록 할 수 있다.

그 방법은 아래와 같다.
- 서버에서 최종적으로 인증에 성공햇을 때 보내는 Authentication-Info 헤더에 다음 난스 값을 미리 제공하기
- 제한된 난스 재사용: 제한적으로 N번 혹은 몇 초간 재사용 허락하는 방식
- 동기화된 난스 생성: 공유된 비밀키에 기한하여 클라와 서버가 순차적으로 같은 난스를 생성하도록 하는 방식

### 실제 상황에 대한 고려
##### 다중 인증요구
서버에서 여러 인증 프로토콜에 대해 요구할 수 있는데, 클라에선 반드시 자신이 지원할 수 있는 가장 강력한 인증 메커니즘을 선택해야 한다.
##### 오류 처리
요청의 요약값이 맞지 않으면, 로그인이 실패했음을 기록하여 반복된 실패가 있는 지 파악해 공격자가 비밀번호 추측을 시도하고 있는 지를 확인해라.
##### 보호공간
WWW-Authentication: domain 필드는 어떤 자격을 통해 인증이 자동으로 적용되는 영역을 결정한다. 하위 도메인은 전부 같은 보호공간에 속하고, 다른 도메인은 다른 보호공간에 속하니 새로운 인증이 필요할 수도 있다.
##### URI 다시 쓰기
프록시가 URI를 변경할 수 잇는 동시에, 다이제스트 인증은 URI 값의 무결성을 검사하므로, 다이제스트 인증은 이러한 변경에 의해 실패할 수 있다.
##### 캐시
다음의 두 Cache-Control 지시자 중 하나가 응답에 존재하지 않는 한 다른 요청에 대해 그 응답을 반환해서는 안된다.
- 만약 원 서버의 응답이 "must-revalidation" Cache-Control 지시자를 포함한 경우, 캐시는 그 응답의 엔터터를 다음 요청에 대한 응답을 위해 활용할 것이다. 그러나 원 서버가 새요청을 인증할 수 있도록, 우선 그 요청의 헤더를 이용해서 재검사를 수행해야한다.
- 만약 원 서버의 응답이 "public" Cache-Control 지시자를 포함한 경우, 응답 엔터티는 그 다음에 오는 임의의 요청에 대한 응답으로 반환될 수 있다.
