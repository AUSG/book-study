# 파티셔닝

### 파티셔닝과 복제
- 보통 각 파티션의 복사본을 여러 노드에 저장함
- 이를 통해 **내결함성 확보**

- $ 파티셔닝의 목적은 데이터 질의 부하를 노드 사이에 고르게 분배하는 것
- @ skewed: 고르게 분배되지 않았을 경우
- @ 핫스팟: 불균형하게 부하가 높은 파티션

### 키 - 값 데이터 파티셔닝
- 키 범위 기준
    - 범위 스캔에 장점
    - 특정한 접근 패턴에 따라 핫스팟 유발
- 키의 해시값 기준
    - 대부분 사용하는 패턴
    - 범위 스캔을 할수 없음

### 파티션 재균형화
재균형화 중에도 기대하기를 원하는 최소 요구사항이 있음
- 재균형화 후, 분하가 노드들 사이에 균등하게 분배되어야 한다.
- 재균형화 도중에도 데이터 베이스는 읽기 쓰기 요청을 처리할 수 있어야 한다.
- 재균형화가 빨리 실행되고 네트워크와 디스크 I/O 부하를 최소화할 수 있도록 노드들 사이에 데이터가 필요 이상으로 옮겨져서는 안된다.

##### 재균형화 전략
- 파티션 개수 고정
    - 파티션을 노드 대수보다 많이 만들고 각 노드에 여러 파티션을 할당하는 방식
    - 노드를 늘리게 되면, 각 노드들에서 파티션을 차출해서 옮기는 방식
    - 파티션 개수를 적절하게 해야하며, 파티션 크기 또한 적절하게 설정해야 한다.
    - ! 키 범위 파티셔닝을 사용하는 경우엔 모든 데이터가 한 파티션에 저장될 수 있다.
- 동적 파티셔닝
    - 파티션의 크기가 설정된 값을 넘어서면 파티션을 두 개로 쪼개 각각에 원래 파티션의 절반 정도의 데이터가 포함되게 하는 방식
    - 파티션 개수가 전체 데이터 용량에 맞춰 조정됨
    - ! 데이터가 없을 때 즉, 시작할 때는 파티션이 하나라는 단점이 있음. 그래서 요청이 하나의 노드에서만 실행될 수 있음.
- 노드 비례 파티셔닝
    - 하나의 노드에 고정된 개수의 파티션을 할당하도록 하는 방식
    - 데이터 용량이 커지면서 파티션의 크기가 커질 수 있지만, 노드를 추가해 부하를 분산시킬 수 있음.
    - 개별 파티션 크기가 상당히 안정적으로 유지된다고 함.
- 
