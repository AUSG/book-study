# 10. 실시간 게임 순위표

man-in-the-middle attack : 사용자가 프락시를 설치하고 점수를 마음대로 바꾸는 중간자 공격

- 클라이언트가 점수를 정하게 하면 일어날 수 있는 문제 중 하나

# 레디스

### 정렬집합

내부적으로 해시테이블과 스킵리스트를 사용하여 정렬된 집합 제공

- 해시 테이블 : 사용자 점수를 저장하기 위해서 사용
- 스킵리스트 : 특정 점수를 딴 사용자들의 목록을 저장하기 위해서 사용

### 레디스 규모 확장

- 데이터 샤딩
  - 고정 파티션
    - 데이터를 다른 파티션에 다시 저장해야하는 경우가 빈번히 발생할 수 있음
  - 해시 파티션
    - 찾기 어려움

# 서버리스

람다를 사용하여 서버리스로 구현하면 스케일아웃에 대한 걱정을 딱히 안 해도 됨

# NoSQL

전역 보조 색인으로 score를 사용하여 효율적으로 구현 가능

# 11. 결제 시스템

# 결제 서비스 전체흐름

![IMG_8416.heic](https://prod-files-secure.s3.us-west-2.amazonaws.com/af55a34b-9237-4a8d-9996-7f267aeaa8d5/f7b571a9-6224-4115-a73e-a3c921141065/IMG_8416.heic)

# 조정

비동기적으로 통신하는 경우 메시지가 100% 전달된다는 보장이 없음

⇒ 주기적으로 비교하면서 상태를 관리

# 한 번 결제 하기

- 최소 한 번 + 최대 한 번

### 최소 한 번 결제

재시도 큐 등을 사용

- 즉시 재시도
- 고정 간격 재시도
- 증분 간격 재시도
- 지수적 백오프
- 취소

### 최대 한 번 결제

멱등성 키를 사용하여 같은 키값에 대한 처리는 한 번만

# 결제 보안

### 사이버 공격. 몇가지 문제들

- 요청/응답 도청
- 데이터 변조
- 중간자 공격
- 데이터 손실
- 분산 서비스 거부 공격
- 카드 도난
- PCI 큐정 준수
- 사기
