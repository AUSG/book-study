# 오류
모든 것이 잘못될 수도 있고 잘못될 것이기 때문에 오류 사례를 신중하게 판단해 코드를 작성해야 한다.

## 복구 가능성
오류가 발생했을 때, 복구가 가능한지의 의미에 대해 알아본다.

### 복구 가능한 오류
특정 오류에 의해 시스템이 멈추지 않는다.

- 전화번호 잘못 입력하는 경우
- 네트워크 오류

### 복구 불가능한 오류
개발자가 코드의 어느 부분에서 '뭔가를 망쳐놓은 것'이다.

- 잘못된 입력 인수로 호출
- 상태를 초기화하지 않음

### 호출하는 쪽에서만 오류 복구 가능 여부를 알 때가 많다.

## 견고성 vs 실패
- 실패: 더 높은 코드 계층이 오류를 처리하게 하거나 전체 프로그램의 작동 정지
- 견고성: 오류를 처리 후 계속 진행
실패가 최선인 이유에 대해 설명한다.

### 신속하게 실패하라
가능한 문제의 실제 방생 지점으로부터 가까운 곳에서 오류를 나타낸 것이다.

### 요란하게 실패하라
오류가 발생하는데도 불구하고 아무도 모르는 상황을 막기 위한 방법 중 하나이다.

### 복구 가능성의 범위
견고함과 실패 사이의 trade-off를 고려해야한다.
오류를 알아차리기 위해 코드의 독립적이거나 중요하지 않은 부분을 전송되게 하면 좋다.

### 오류를 숨기지 않음
오류를 숨기는 것은 복구할 수 있는 오류와 복구할 수 없는 오류 모두에 문제를 일으키기에 바람직하지 않다.
#### 기본값 반환
오류가 발생한 사실을 숨기고 호출하는 쪽에서 모든 것이 정상인 것처럼 계속 진행한다.
#### 널 객체 패턴
널 객체는 실제 반환값처럼 보이지만 오류 처리에 사용하는 것은 바람직하지 않다.
#### 아무것도 하지 않음
오류가 발생했다는 신호를 아예 보내지 않는 것도 바람직하지 않다.


## 오류 전달 방법
오류가 발생하면 일반적으로 더 높은 계층으로 오류를 알려야 한다.
- 명시적 방법: 코드를 직접 호출한 쪽에서 오류가 발생할 수 있음을 인지할 수밖에 없도록 한다.
- 암시적 방법: 코드를 호출하는 쪽에 오류를 알리지만 호출하는 쪽에서 그 오류를 신경 쓰지 않아도 된다.

### 요약: 예외
- 예외는 일반적으로 개발자들의 요구사항에 맞게 충분한 기능을 가진 클래스로 구현된다.

> TODO: Checked, Unchecked Exception 복습

### 명시적 방법: 검사 예외

#### 검사 예외를 사용한 오류 전달
함수는 검사 예외를 발생시킬 수 있음을 선언하고 (throw) 오류를 발생하면 검사 예외를 발생시킨다.

#### 검사 예외 처리
호출하는 쪽에서도 검사 예외가 발생하면 이를 파악하고 적절하게 처리해줄 수 있다. (try catch)

### 암시적 방법: 비검사 예외
코드 계약에 있어 세부 조항에 해당한다.

#### 비검사 예외를 사용한 오류 전달
비검사 예외가 발생할 수 있음을 문서로 전달한다. 

함수 정의부에서 비검사 예외가 발생할 수 있음을 정의하지 않고 실제 오류가 발생한 곳에서 예외를 발생시킨다.
#### 비검사 예외 처리
함수를 호출하는 쪽은 예외를 확인하고 처리하지 않아도 된다.

### 명시적 방법: 널값이 가능한 반환 유형
널 안전성을 지원하는 상황에서 널값이 가능한 반환 유형을 사용해 명시적으로 오류를 전달할 수 있다.

널값이 가능한 반환 유형을 정의하고 호출하는 쪽에서 확인해볼 수 있다.

### 명시적 방법: 리절트 반환 유형
널값이나 옵셔널 타입을 반환할 때 문제 중 하나는 오류 정보를 전달할 수 없다는 것이다.

result 유형을 통해 값을 얻을 수 없는 이유를 알려줄 수 있다.

### 명시적 방법: 아웃컴 반환 유형
어떤 일을 수행하고 그 동작의 결과 값을 반환하도록 설계할 수 있다.

### 암시적 방법: 프로미스 또는 퓨처
비동기적으로 실행하는 코드를 작성할 때, promise나 future을 사용해 오류 상태를 전달해볼 수 있다.

일반적으로 오류 처리를 강제로 해야 하지 않고 세부 조항을 잘 알지 못하면 오류 처리 코드를 생략할 수 있기 때문에 암시적인 방법이다.

result 유형의 프로미스를 반환하면 명시적인 방법이 된다. (하지만 코드가 복잡해진다)

### 암시적 방법: 매직값 반환
magic value: 함수의 정상적인 반환 유형에 적합하지만 특별한 의미를 부여하는 값이다.


## 복구할 수 없는 오류의 전달
일반적으로 복구할 가능성이 없는 오류가 발생하면 신속하고 요란하게 실패하는 것이 최상의 방법이다.
  - 비검사 예외 발생
  - 프로그램이 panic이 되도록
  - check나 assertion 사용

## 호출하는 쪽에서 복구하기를 원할 수도 있는 오류의 전달
비검사 예외와 명시적 오류 전달 기법 중 어느 것을 사용해야 하는지 논쟁이 있다.

### 비검사 예외를 사용해야 한다는 주장
코드 구조를 개선할 수 있기 때문에 비검사 예외를 사용해야 한다.
개발자가 너무 많은 명시적 오류 전달을 접하면 무시하기 시작한다. -> 남발하지말자...

### 명시적 기법을 사용해야 한다는 주장
매끄러운 오류 처리가 가능하다.
실수로 오류를 무시할 수 없다.
문서화되지 않은 비검사 예외가 훨씬 실용적이지 않다.

### 필자의 의견: 명시적 방식을 사용하라
코드베이스 전반에 걸쳐 완전히 문서화 되는 경우가 드물다.

비검사 예외가 가져오는 리스크가 너무 크다.

## 컴파일러 경로를 무시하지 말라
킹텔리제이를 무시하지 말자.