 # 9. 코드를 재사용하고 일반화할 수 있도록 하라

## 9.1 가정을 주의하라

-   가정은 코드 재사용 시 버그를 초래할 수 있다
    -   불필요한 가정을 피하라 혹은 가정이 필요하면 강제적으로 하라



## 9.2 전역 상태를 주의하라

-   전역 상태를 가진 코드는 재사용하기 안전하지 않을 수 있다
    -   공유상태에 의존성을 주입해서 해결할 수 있음



## 9.3 기본 반환 값을 적절하게 사용하라

-   낮은 층위의 코드의 기본 반환값은 재사용성을 해칠 수 있다
    -   상위 수준에서 기본값을 제공하라



## 9.4  함수의 매개변수를 주목하라

-   필요 이상으로 매개변수를 받는 함수는 재사용하기 어려울 수 있다
    -   함수는 필요한 것만 매개변수로 받도록 하라



## 9.5  제네릭의 사용을 고려하라

-   특정 타입에 의존하면 일반화를 제한한다
    -   제네릭을 사용하라



# 10. 단위테스트의 원칙

## 10.1 단위 테스트 기초

-   테스트 중인 코드 ( code under test / system under test )
    -   테스트의 대상이 되는 코드
-   테스트 코드
    -   테스트를 구성하는 코드
-   테스트 케이스
    -   준비 - 실행 - 단언 섹션으로 사용 ( given - when - then  )
-   테스트 러너
    -   테스트를 실행하는 코드



## 10.2 좋은 단위 테스트는 어떻게 작성할 수 있는가?

-   훼손의 정확한 감지
    -   코드에 대한 초기 신뢰를 준다
    -   미래의 회손을 막아줌
        -   회귀를 탐지할 목적으로 테스트를 실행하는 것 => 회귀 테스트
-   세부 구현 사항에 독립적
    -   코드의 변경은 "기능적 변화", "리팩터링" 이 있음
    -   기능적 변화에서는 테스트 코드도 같이 수정되기를 기대되지만, 리팩터링은 아님
    -   구현 세부사항에 의존하지 않으면 코드 리팩터링에 실수가 있었는 확인해주는 테스트 결과를 신뢰할 수 있음
-   잘 설명되는 실패
-   이해할 수 있는 테스트 코드
-   쉽고 빠르게 실행



## 10.3 퍼블릭 API에 집중하되 중요한 동작은 무시하지 말라

-   중요한 동작이 퍼블릭 API 외부에 있을 수 있다
    -   서버와 상호작용하는 코드
    -   데이터베이스에 값을 저장하거나 읽는 코드



## 10.4 테스트 더블

-   테스트 더블을 사용하는 이유
    -   테스트 단순화
    -   테스트로부터 외부 세계 보호
    -   외부로부터 테스트 보호
-   목과 스텁은 문제가 될 수 있다
    -   실제적이지 않은 테스트를 만들 수 있음
    -   목과 스텁을 사용하면 테스트가 구현 세부 정보에 유착될 수 있음

-   목과 스텁 대신 페이크를 사용하라



## 10.5 테스트 철학으로부터 신중하게 선택하라

-   TDD, BDD, ATDD 이런 것들에 끌려다니지 말고 신중히 선택



# 11. 단위테스트의 실제

## 11.1 기능뿐만 아니라 동작을 시험하라

-   함수당 하나의 테스트 케이스만 있으면 적절하지 않을 때가 많다
    -   각 동작을 테스트하는데 집중하라



## 11.2 테스트만을 위해 퍼블릭으로 만들지 말라

-   프라이빗 테스트하는 것은 바람직하지 않을 때가 많다
-   퍼블릭 API를 통해 테스트하라
-   코드를 더 작은 단위로 분할하라



## 11.3 한 번에 하나의 동작만 테스트하라

-   여러 동작을 한꺼번에 테스트하면 테스트가 제대로 안 될 수 있다
    -   각 동작은 자체 테스트 케이스에서 테스트하라
-   매개변수를 사용한 테스트를 사용하라



## 11.4 공유 설정을 적절하게 사용하라

-   상태 공유는 문제가 될 수 있다
    -   상태를 공유하지 않거나 적절히 초기화하라
-   설정 공유는 문제가 될 수 있다
    -   중요한 설정은 테스트 내에서 하도록해라
-   테스트에 필요하지만 그다지 중요하지 않은 설정은 공유해도 괜찮음



## 11.5 적절한 어서션 확인자를 사용하라

-   부적합한 확인자는 테스트 실패를 잘 설명하지 못할 수 있음
    -   적절한 확인자를 사용하라



## 11.6 테스트 용이성을 위해 의존성 주입을 사용하라

-   하드 코딩된 의존성은 테스트를 불가능하게 할 수 있다

    -   의존성 주입을 사용하라

    