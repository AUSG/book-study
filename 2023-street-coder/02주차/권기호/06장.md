# 해커를 넘어서
보안은 취약성, 남용, 공격 뿐만 아니라 관련 없는 다른 요인 때문에 침해될 수 있다.

# 위협 모델
위협 모델: 보안 측면에서 무엇이 잘못될 수 있는지를 명확히 이해하는 것

위협 모델의 목표는 수행해야 하는 보안 조치의 우선순위를 정하고, 비용을 최적화하고, 효율성을 높이는 것이다.

## 주머니에 들어갈 만큼 작은 위협 모델 만들기
기본으로 애플리케이션을 위한 소형 위협 모델이 필요하다.

다음 요소를 포함한다.
- 애플리케이션 자산: 기본적으로 소스 코드, 설계 문서, DB, 개인 키, API 토큰, 서버구성 등
- 자산 저장 서버: 잠재적인 문제 파악
- 정보 민감성: 정보의 잠재적인 피해
- 리소스에 대한 엑세스 경로: 엑세스의 여부

# 웹 앱을 안전하게 작성하라

## 보안에 염두에 두고 설계해라
나중에 개선하기 어려우므로 설계부터 고려하라.

1. 위협 모델 검토
2. 보안 암호 저장 위치 고려
3. 최소한의 권한 부여
4. 원칙을 조직 전체에 적용

## 은둔 보안 방식의 유용성
위협 모델에 기초하여 보안의 우선순위를 정하라. 은둔 보안도 효과가 있을 수 있다.

## 자신만의 보안을 구현하지 마라
보안 전문가도 해시 알고리즘을 구현하는데 어려움을 겪는다. 직접 구현하지 말자.

## SQL 삽입 공격

SQL을 삽입하여 퀴리를 조작하는 것.

```sql
SELECT id FROM users WHERE username='<사용자 이름>'
```
<사용자 이름>에 쿼리를 입력하여 예상치 못한 쿼리를 실행하게 된다.

### SQL 삽입에 대한 잘못된 해결법
이스케이핑: '를 "로 바꾼다.

### SQL 삽입에 대한 이상적인 해결 방안
매개변수화된 쿼리를 통해 해결 가능하다. 또한 쿼리 계획 캐시로 성능이 향상된다.

### 매개변수화된 쿼리를 사용할 수 없을 경우
- 올바른 수치 타입 파싱
- 유효하지 않는 문자 제거

## XSS
사이트 간 스크립팅
1. 페이지에 자바스크립트 코드 삽입
2. 네트워크를 통한 더 큰 자바스크립트 코드 로드하여 웹 페이지 실행

### JS 삽입
원격 URL에서 JS 코드를 로드하여 이 페이지에서 그 코드를 실행할 수 있다.

### XSS 방지
특수 HTML 문자를 이스케이프하도록 텍스트를 인코딩할 수 있다.

### CSP
서드 파티 서버가 요청할 수 있는 리소스를 제한하는 HTTP 헤더를 의미한다.

## CSRF, XSRF
웹 응용 프로그램 보안과 관련이 있으며 공격자가 사용자의 권한으로 웹 애플리케이션에서 악의적인 요청을 실행하도록 하는 공격

# 첫 번째 플러드 그리기
서비스 거부 공격은 서비스가 멈추도록 만드는 가장 대표적인 이름이다.

## 캡차를 사용하지 마라
캐차의 문제점은 질문이 사람이 답변하기에도 어렵다.

## 캡차의 대체 방안
성능을 고려하여 코드를 작성하고 캐시를 공격적으로 사용하며 필요에 따라 스로틀링을 사용하라.

## 캐시를 구현하지 마라
가능하면 프레임워크에서 제공하는 기존의 캐시 인프라를 활요해라.

# 암호 저장하기
암호를 안전하게 저장하는 보관하는 것은 보안 위협을 완화하는 한 가지 방법이다.

## 소스 코드에 암호를 유지하는 것
컴퓨터 유출, 코드 유출 등의 이유로 안전하지 않음

### 올바른 스토리지
암호 관리자를 콜드 스토리지로 사용하거나 스토리지 암호를 사용해라.

### 데이터는 언젠가는 유출된다
항상 데이터가 유출될 수 있는 위험을 가정하고 이에 대비하여 설계해라.

### 필요없는 데이터는 수집하지 않는다.
서비스 기능에 영향을 준다고 생각되는 데이터가 아니라면, 다른 데이터를 수집하는 것에 적극적으로 반대하라.

### 올바른 비밀번호 해싱 방법
사용중인 프레임워크에서 지원하는 알고리즘을 선호하는 것이 좋다.

### UUID는 랜덤이 아니다.