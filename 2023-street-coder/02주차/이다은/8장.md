# 8장. 기분 좋은 확장성
- lock은 thread-safe한 코드를 작성하기 위한 기능이다.
- 레이스 조건(경쟁 조건): 모든 스레드가 다른 스레드를 고려하지 않고 데이터를 자체적으로 조작하는 방식
- 잠금: 다른 CPU 코어가 같은 메모리 영역에서 동시에 읽거나 쓰는 것을 차단
- 잠금을 남용하지 말자.

<br/>

- 성능과 확장성이 크게 향상된다면 신뢰성이 조금 낮아도 괜찮은 경우가 있다.
- NOLOCK의 트레이드 오프를 잘 알고 사용해보자.
  - 일시적으로 일관성 맞지 않을 수 있지만 잠금 없애 성능 향상

<br/>

- 데이터베이스에서 단일 연결을 하나 만들고 다른 코드에서 공유하지 마라.
- ORM을 사용해보자.

<br/>

- 선점형 스케줄링을 활용해 마치 멀티태스킹 하는 거처럼 보이게 한다. 다만, 이게 경우에 따라 확장성을 해칠 수도 있다.
- I/O 작업이 없으면 비동기도 필요 없다.
- 동기화된 컨텍스트에서 비동기 함수를 안전하게 호출하는 건 매우 어렵기 때문에 함께 사용하지 마라.
- 비동기 I/O는 리소스를 덜 소모하기 때문에 I/O가 많이 필요한 코드에서 멀티스레팅보다 더 나은 확장성을 제공한다.
  - 하지만 택일 할 필요는 없다.
- 무조건적으로 MSA를 택하지 마라. 모놀리스를 고려해라.
