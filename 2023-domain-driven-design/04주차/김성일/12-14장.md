# 12장 모델과 디자인 패턴의 연결

## STRATEGY

-   프로세스에서 변화하는 부분을 별도의 STRATEGY 객체로 분리해서 모델에 표현
-   규칙과 제어하는 행위를 분리
-   규칙이나 대체 가능한 프로세스를 구현



## COMPOSITE

-   복잡한 도메인을 모델링하는 동안 종종 중요한 객체가 여러 개의 작은 부분으로 조합되어 구성돼 있는 경우가 있다
-   COMPOSITE 내부에 포함된 모든 구성요소를 포괄하는 추상타입을 정의하라
-   컨테이너에 포함된 항목의 집계 정보를 반환할 수 있게 정보를 제공하는 메서드를 컨테이너에 구현하라



# 13장 더 심층적인 통찰력을 향한 리팩터링

-   리팩터링은 도메인을 더욱 심층적으로 이해한 개발자가 더 명쾌하고 유용한 모델로 개선할 수 있는 여지를 발견하는 과정에서 얻게 된 학습의 결과



## 조사

-   모델을 좀 더 명확하고 자연스럽게 의사소통할 수 있게 만들어줄 개선안을 조사하자.
-   이런 조사 과정을 생산성 있게 진행하는 비결
    -   자기 결정
        -   설계 문제를 조사하기 위해 즉시 규모가 작은 팀을 소집할 수 있다
    -   범위와 휴식
        -   며칠에 걸쳐 두세 번 정도의 짧은 회의를 진행한 후 시도할 가치가 있는 설계안을 도출
    -   UBIQUITOUS LANGUAGE 사용
        -   주제 영역의 전문가를 포함시켜 UBIQUITOUS LANGUAGE를 사용. 이를 통해 UBIQUITOUS LANGUAGE가 자연스럽게 발전



## 선행 기술

-   항상 바퀴를 다시 발명할 필요는 없다
-   일반적인 정형화가 일부 도메인 영역에 적합하다면 해당 영경을 분리한 후 거기에 막제 형식 체계의 규칙을 조정할 수 있다



## 개발자를 위한 설계

-   심층적인 통찰력을 향해 리팩터링을 하면, 유연한 설계에 이르기도 하고 덕분에 리팩터링 과정이 손쉬워지기도 한다.
-   유연한 설계는 설계의 의도를 전달한다.



## 타이밍

-   변경을 완벽하게 정당화할 수 있을 때까지 기다린다면 지나치게 오랫동안 기다린 셈이다.
-   다음과 같은 경우 리팩터링이 필요
    -   현재 팀에서 도메인을 이해하고 있는 바가 설계에 표현돼 있지 않은 경우
    -   중요한 개념이 설계상에 암시적으로 표현돼 있는 경우(그리고 개념을 명확하게 표현할 수 있는 방법이 보이는 경우)
    -   설계상의 중요한 부분을 더욱 유연하게 만들 기회가 보이는 경우



## 위기를 기회로

-   어느 순간 갑자기 모든 것을 뒤흔드는 통찰력을 얻는다.
-   이런 상황은 종종 기회가 아닌 위기로 보인다. 하지만 이는 팀이 새로운 이해에 도달했다는 의미이고, 팀은 더 훌륭한 모델을 생각해낼 수 있다.



# 14장 모델의 무결성 유지



##  BOUNDED CONTEXT

-   규모가 큰 프로젝트에서는 다수의 모델이 사용되기 마련이다
-   개별적인 모델을 기반으로 작성된 코드가 한데 섞이면 많은 버그가 발생하고 신뢰성이 떨어진다
-   아울러 팀 구성원 간의 의사소통이 혼란스러워진다



>   모델이 적용되는 컨텍스트를 명시적으로 정의하라. 이 경계 내에서는 모델을 엄격하게 일관된 상태로 유지하고, 경계 바깥의 이슈 때문에 초점이 흐려지거나 혼란스러워져서는 안된다.



## CONTINUOUS INTEGRATION

>   BOUNDED CONTEXT를 정의했다면 이를 건전한 상태로 유지해야 한다.

-    다수의 사람이 동일한 BOUNDED CONTEXT 내에서 작업할 경우 모델이 단편화될 가능성이 높다.
-   팀의 규모가 커지면 문제도 증폭되지만 서너 명 정도에 달하는 소수의 인원으로 구성 된 팀도 심각한 문제에 마주칠 수 있다
-   그렇다고 시스템을 더 작은 CONTEXT 로 분할한다면 결국 가치 있는 수준의 통합과 응집성을 잃게 되는 결과가 초래된다.



통합을 위한 가장 효과적인 프로세스의 공통점

-   단계적이고 재생 가능한 병합 / 빌드 방법
-   자동화된 테스트 스위트
-   통합되지 않은 상태로 존재할 수 있는 시간을 적당히 짧게 유지하는 규칙



## CONTEXT MAP

-   다른 팀에 속한 사람들은 CONTEXT 간의 경계를 인식하지 못할 것이며, 따라서 자신도 모르는 사이 CONTEXT의 경계를 흐리게 하거나 연결되는 방식을 복잡하게 바꿀 것이다.
-   서로 다른 CONTEX를 연결하는 경우 서로에게 스며드는 경향이 있다.

-   유용한 모델을 식별하고 각 BOUNDED CONTEXT를 정의하라. 여기에는 비 객체지향적인 하위 시스템에 대한 암시적인 모델도 포함된다. 각 BOUNDED CONTEXT에 이름을 부여하고 이 이름을 UBIQUITIOUS LANGUAGE의 일부로 포함시켜라.



## SHARED KERNEL

-   두 팀 간에 공유하기로 한 도메인 모델의 부분집합을 명시하라. 
-   물론 여기에는 모델의 부분집 합뿐 아니라 모델 요소와 연관된 코드나 데이터베이스 설계의 부분집합까지도 포함된다. 
-   명시적으로 공유하는 부분들은 특별한 상태를 가지며, 다른 팀과의 협의 없이는 변경할 수 없다.



## CUSTOMER / SUPPLIER DEVELOPMENT TEAM

-   변경에 대한 거부권이 하류 팀에 있거나 변경 요청 절차가 지나치게 복잡하다면 상류 팀이 자유롭게 개발을 진행하는 데 하류 팀에 속박당할 여지가 있다.
-   상류 팀이 하류 시스템을 망가뜨릴지도 모른다는 두려움 없이 코드를 수정하고 하류 팀 이 지속적으로 상류 팀을 감시하지 않고도 자신의 작업에 집중할 수 있게 자동화된 테스트 스위트가 마련돼 있어야 한다.


## CONFORMIST

-   두 개발 팀이 상류/하류 관계를 맺고 있고 상류 팀이 하류 팀의 필요성을 충족시킬 충분한 동기를 느낄 수 없다면 하류 팀은 속수무책으로 무력해질 수 밖에 없다.


## ANTICORRUPTION LAYER

-   클라이언트 고유의 도메인 모델 측면에서 기능을 제공할 수 있는 격리 계층을 만들어라.
-   격리 계층은 기존에 이미 존재하는 인터페이스를 거쳐 다른 시스템과 통신하므로 다른 시스템을 거의 수정하지 않아도 된다.
-   해당 계층에서는 내부적으로 필요에 따라 두 모델을 상대로 양방향으로 번역을 수행한다.



## SEPERATE WAYS

>   두 기능 간의 관계가 필수적인 것이 아니라면 두 기능은 서로 관계를 끊을 수도 있다.

-   통합은 언제나 비용이 많이들고, 때로는 혜택이 적은 경우도 있다.



## OPEN HOST SERVICE

-   어떤 하위 시스템을 다른 여러 하위 시스템과 통합해야 할 경우 각 하위 시스템에 대한 번역기를 조정한다면 팀 전체가 교착 상태에 빠질 수 있다. 변경이 발생할 때는 유지보수하고 걱정해야 할 일이 더욱 더 많은 법이다.

-   하위 시스템 접근과 관련된 프로토콜을 일련의 SERVICE로 정의하라.
-   프로토콜을 공개해서 개발 중인 시스템과 통합하고자 하는 모든 이들이 해당 프로토콜을 사용할 수 있게 하라.



## PUBLISHED LANGUAGE

-   필요한 도메인 정보를 표현할 수 있는 적절히 문서화된 공유 언어를 공통의 의사소통 매개체로 사용해서 필요에 따라 해당 언어로, 또는 해당 언어로부터 번역을 수행하라.
