# 09~11

- [09~11](#0911)
- [09. 암시적인 개념을 명확하게](#09-암시적인-개념을-명확하게)
  - [언어에 귀를 기울여라](#언어에-귀를-기울여라)
    - [어색한 부분을 조사하라](#어색한-부분을-조사하라)
    - [모순점에 대해 깊이 고민하라](#모순점에-대해-깊이-고민하라)
    - [서적을 참고하라](#서적을-참고하라)
    - [시도하고 또 시도하라](#시도하고-또-시도하라)
  - [Specification](#specification)
- [10. 유연한 설계](#10-유연한-설계)
  - [Intention Revealing Interface(의도를 드러내는 인터페이스)](#intention-revealing-interface의도를-드러내는-인터페이스)
  - [Side Effect Free Function](#side-effect-free-function)
  - [Assertion](#assertion)
  - [Conceptual Contour(개념적 윤곽)](#conceptual-contour개념적-윤곽)
  - [Standalone Class(독립형 클래스)](#standalone-class독립형-클래스)
  - [Closure of Operation(연산의 닫힘)](#closure-of-operation연산의-닫힘)
- [11. 분석 패턴의 적용](#11-분석-패턴의-적용)

# 09. 암시적인 개념을 명확하게

## 언어에 귀를 기울여라

도메인 전문가가 사용하는언어에 귀기울여라. 복잡하게 뒤얽힌 개념들을 간결하게 표현하는 용어가 있는가?

- 여러분이 선택한 단어를 (아마도 더 적절하게) 고쳐주는가?
- **여러분이 특정 문구를 이야기할 때 도메인 전문가의 얼굴에서 곤혹스러운 표정이 사라지는가?**
- 이 모두가 바로 모델에 기여하는 개념의 실마리에 해당한다.

### 어색한 부분을 조사하라

- 여기서 개선점이 나올 것이다.

### 모순점에 대해 깊이 고민하라

- 어떤 모순은 도메인을 잘못 이해하는 데서 발생한다.
- 용어를 다르게 쓰는 데서도 발생하고
- 이 뿐만 아니라 두 도메인 전문가가 서로 모순되는 사실을 진술하는 경우도 있다.

### 서적을 참고하라

때때로 모델의 개념을 깊이 이해하기 위해 관련 서적을 참고하는 것도 도움이 된다.

### 시도하고 또 시도하라

저자의 경우 모델에서 시도해볼 수 있을 만큼 명확하고 유용해 보이는 지식을 발견하기까지 대화로 표현한 시행착오를 6번 정도는 반복해야 했다.

- 이런 시행착오를 두려워하지 마라.
- 시행착오를 통한 실험은 유용한 것이 무엇인지 분별하는 능력을 배우는 방법이다.
- 설계 과정에서 실수를 피하려고 발버둥친다면 더 적은 경험을 바탕으로 설계를 해야 하는 탓에 품질이 더 낮은 결과물을 얻게 될 것이다.

## Specification

- 특정한 종류의 규칙을 표현하는 매우 간결한 수단.
- 조건 로직으로부터 규칙을 분리하고 규칙이 모델 내에서 분명해지게끔 만듬
- 검증에도 사용할 수 있고
- 조회를 위한 명세로도 사용할 수 있다 (repository를 주입받는 spec)
- 핵심은 Specification을 둠으로써 표현력을 올리고 인터페이스를 통한 디커플링, 그리고 서로 다른 작업자의 유연한 코드 수정의 효과를 가짐

# 10. 유연한 설계

- 개발이 진행될수록 현재의 레거시 코드로 인한 중압감에 시달리지 않고 프로젝트 진행을 촉진하려면 변경을 수용하고 즐겁게 작업할 수 있는 설계가 필요하다.
- 이것이 바로 유연한 설계다(supple design)
- 그리고 유연한 설계는 심층 모델링을 보완한다.

![image](https://github.com/AUSG/2023-book-study/assets/72328687/6c72d5d6-4c16-4982-8d12-5bb3a0863ab8)

## Intention Revealing Interface(의도를 드러내는 인터페이스)

**수행 방법에 관해서는 언급하지 말고 결과와 목적만을 표현하도록 클래스와 연산의 이름을 부여하라**

그렇지 않고 개발자가 객체를 효과적으로 사용하는 데 알아야 할 정보를 인터페이스로부터 얻지 못한다면 세부적인 측면을 이해하고자 객체 내부를 깊이 파고들어야한다.

- **이러면 캡슐화로부터 얻을 수 있는 대부분의 가치를 잃어버린다.**
- 우리는 언제나 인지 과부화와 힘겨운 투쟁을 벌여야 한다.

## Side Effect Free Function

**가능한 한 많은 양의 프로그램 로직을 사이드 이펙트가 없는 순수 함수로 작성하라**

- 도메인 정보를 반환하지 않는 아주 단순한 연산으로 엄격하게 명령을 분리하라
- 책임에 적합한 어떤 개념이 나타난다면 value object로 옮겨서 사이드 이펙트를 통제하라

## Assertion

**Assertion을 사용하면 Entity의 사이드이펙트가 명확해지고 다루기 쉬워진다.**

- spec보다는 강하게 “사실임을 보장한다”의 의미가 강하다
- 코드 내에 assertion을 명시할 수 없다면 테스트를 작성해 assertion을 명시하라.
- 개발자들이 의도된 assertion을 추측할 수 있게 인도하고, 쉽게 배울 수 있고 모순된 코드를 작성하는 위험을 줄이는 응집도 높은 개념이 포함되도록 모델을 만들려고 노력하라.

연산의 사이드 이펙트가 단지 구현에 의해서만 함축적으로 정의된다면

- 다수의 위임(delegation)을 포함하는 설계에서는 인과 관계로 혼란스러워진다.
- 그리고 결국 프로그램을 이해하기 위해 분기 경로를 따라 실행 경로를 추적하는 수밖에 없다.
- **이렇게 되면 캡슐화의 가치가 사라지고, 구체적인 실행 경로를 추적해야 한다는 필요성으로 추상화가 무의미해진다.**

## Conceptual Contour(개념적 윤곽)

중요 영역을 나누는 것과 관련한 직관을 감안해서 도메인의 설계 요소를 응집력 있는 단위로 분해하라

새로 알게 된 개념이나 요구사항을 코드에 적용하다 보면 Conceptual Contour가 눈에 보인다.

계속적인 리팩토링을 토대로 변경되는 부분과 변경되지 않는 부분을 나누는 `중심 축`을 식별하고,
변경을 분리하기 위한 패턴을 명확하게 표현하는 `Conceptual Contour(개념적 윤곽)`을 찾아라

- **우선적으로 확실한 지식 영역을 구성하는 도메인의 일관성 있는 측면과 모델을 조화시켜야 한다.**

## Standalone Class(독립형 클래스)

상호의존성은 모델과 설계를 이해하기 어렵게 만든다. 또한 테스트를 어렵게 만들고 유지보수성을 떨어뜨린다. 그리고 이는 쉽게 축적되는 경향이 있다.

- 모듈 내에서조차 의존성이 증가할수면 설계를 파악하는 데 어려움이 가파르게 높아진다.
  - 이는 개발자에게 **정신적 과부하**다
  - 명시적인 참조에 비해 암시적인 개념이 훨씬 더 많은 정신적 과부하를 초래한다.
- **낮은 결합도는 객체 설계의 기본 원리다**
  - **개념적 과부하를 줄이는 기본적인 방법 중 하나이기도 함**
  - 가능한 한 늘 결합도를 낮추고자 노력하고
  - 현재 상황과 무관한 모든 개념을 제거하라.
  - 그러면 클래스를 완전히 독립적으로 바뀌고 의존성이 사라져 이해하기에 부담이 줄고 쉬워진다
  - 가장 복잡한 계산을 Standalone Class로 도출하려고 노력하라
- **단, 의존성 제거가 제멋대로 모델에 포함된 모든 요소를 원시 타입으로 격하시키는 것을 의미하지는 않는다.**

## Closure of Operation(연산의 닫힘)

적절한 위치에 반환 타입과 인자 타입이 동일한 연산을 정의하라

- e.g. 구현자(implementer)가 연산에 사용되는 상태를 포함하고 있다면 연산의 인자로 구현자를 사용하는 것이 효과적이므로 인자의 타입과 반환 타입을 구현자로 동일하게 정의
- 이런 방식으로 정의된 연산은 해당 타입의 인스턴스 집합에 닫혀있다.
- **닫힌 연산은 부차적인 개념을 사용하지 않고도 고수준의 인터페이스를 제공한다.**
- 이 패턴은 value object의 연산을 정의하는 데 주로 사용된다.

# 11. 분석 패턴의 적용

**분석 패턴이란?**

- 마틴 파울러가 제시함
- 업무 모델링 과정에서 발견되는 공통적인 구조를 표현하는 개념의 집합
- 단 하나의 도메인에 대해서만 적절할 수도 있고 여러 도메인에 걸쳐 적용이 가능할 수도 있다.
- 이는 기술적인 해법이 아니라 특정 도메인의 모델을 작성할 때 따를 수 있는 유용한 지침서에 해당한다.
